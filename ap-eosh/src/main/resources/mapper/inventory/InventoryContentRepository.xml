<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.airpremia.eosh.health.inventory.repository.InventoryContentRepository">
    <select id="selectInventoryContentByRootKey" resultType="InventoryContentEntity">
        SELECT ic.content_seq
            , ic.inventory_seq
            , ic.sub_classification_code
            , ic.quantity
            , ic.expiration_dt
            , ic.insert_user_id
            , ic.insert_dtm
            , ic.insert_ip
            , ic.update_user_id
            , ic.update_dtm
            , ic.update_ip
        FROM inventory_content AS ic
        <where>
            AND ic.inventory_seq = #{inventorySeq}
        </where>
        ORDER BY ic.expiration_dt IS NULL
            , ic.expiration_dt ASC
            , ic.content_seq DESC
    </select>

    <select id="selectInventoryContentByRootKeyList" resultType="InventoryContentEntity">
            SELECT ic.content_seq
                , ic.inventory_seq
                , ic.sub_classification_code
                , ic.quantity
                , ic.expiration_dt
                , ic.insert_user_id
                , ic.insert_dtm
                , ic.insert_ip
                , ic.update_user_id
                , ic.update_dtm
                , ic.update_ip
            FROM inventory_content AS ic
            <where>
                AND ic.inventory_seq IN (
                    <foreach collection="inventorySeqList" item="inventorySeq" separator=",">
                        #{inventorySeq}
                    </foreach>
                )
            </where>
            ORDER BY ic.expiration_dt IS NULL
                , ic.expiration_dt ASC
                , ic.content_seq DESC
        </select>

    <insert id="insertInventoryContent">
        INSERT INTO inventory_content (
            inventory_seq
            , sub_classification_code
            , quantity
            , expiration_dt
            , insert_user_id
            , insert_dtm
            , insert_ip
            )
        VALUES (
            #{inventorySeq}
            , #{subClassificationCode}
            , #{quantity}
            , #{expirationDt}
            , #{insertUserId}
            , #{insertDtm}
            , #{insertIp}
            )
    </insert>

    <update id="updateInventoryContent">
        UPDATE inventory_content
        SET sub_classification_code = #{subClassificationCode}
            , quantity = #{quantity}
            , expiration_dt = #{expirationDt}
        	, update_user_id = #{updateUserId}
        	, update_dtm = #{updateDtm}
        	, update_ip = #{updateIp}
        WHERE
        	content_seq = #{contentSeq}
    </update>

    <delete id="deleteInventoryContent">
        DELETE
        FROM inventory_content
        WHERE
        	content_seq = #{contentSeq}
    </delete>

    <delete id="deleteInventoryContentByRootKey">
        DELETE
        FROM inventory_content
        WHERE
            inventory_seq = #{inventorySeq}
    </delete>
</mapper>