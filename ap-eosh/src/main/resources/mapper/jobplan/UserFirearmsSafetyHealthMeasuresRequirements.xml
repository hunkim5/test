<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.airpremia.eosh.jobplan.repository.UserFirearmsSafetyHealthMeasuresRequirementsRepository">

    <select id="selectUserFirearmsSafetyHealthMeasuresRequirements" resultType="UserFirearmsSafetyHealthMeasuresRequirementsDto">
        SELECT
             je.employee_name
            ,ur.user_firearms_safety_health_measures_requirements_seq
            ,ur.employee_number
            ,ur.employee_name
            ,ur.job_seq
            ,ur.job_employee_seq
            ,ur.content_removal_bool
            ,ur.depression_gas_replace_bool
            ,ur.bowl_open_pressure_release_bool
            ,ur.bowl_internal_cleaning_bool
            ,ur.flammability_substance_removal_bool
            ,ur.fire_extinguisher_function_check
            ,ur.safety_net_installation_bool
        FROM job_employee je LEFT JOIN user_firearms_safety_health_measures_requirements ur ON je.job_seq = ur.job_seq AND je.employee_number=ur.employee_number
        WHERE
            je.job_seq = #{jobSeq}
    </select>

    <insert id="insertUserFirearmsSafetyHealthMeasuresRequirements">
       INSERT INTO user_firearms_safety_health_measures_requirements
       (
          employee_number
          ,employee_name
          ,job_seq
          ,job_employee_seq
          ,content_removal_bool
          ,depression_gas_replace_bool
          ,bowl_open_pressure_release_bool
          ,bowl_internal_cleaning_bool
          ,flammability_substance_removal_bool
          ,fire_extinguisher_function_check
          ,safety_net_installation_bool
          ,insert_user_id
          ,insert_ip
       )
       VALUES
       <foreach collection="firearmsSafetyRequirementList" item="item" separator=", ">
        (
          #{item.employeeNumber}
          ,#{item.employeeName}
          ,#{item.jobSeq}
          ,#{item.jobEmployeeSeq}
          ,#{item.contentRemovalBool}
          ,#{item.depressionGasReplaceBool}
          ,#{item.bowlOpenPressureReleaseBool}
          ,#{item.bowlInternalCleaningBool}
          ,#{item.flammabilitySubstanceRemovalBool}
          ,#{item.fireExtinguisherFunctionCheck}
          ,#{item.safetyNetInstallationBool}
          ,#{item.insertUserId}
          ,#{item.insertIp}
        )
        </foreach>
    </insert>

    <update id="updateUserFirearmsSafetyHealthMeasuresRequirementsHarmful">
        UPDATE user_firearms_safety_health_measures_requirements SET
         user_firearms_safety_health_measures_requirements_seq = #{userFirearmsSafetyHealthMeasuresRequirementsSeq}
        ,employee_number = #{employeeNumber}
        ,employee_name = #{employeeName}
        ,job_seq = #{jobSeq}
        ,job_employee_seq = #{jobEmployeeSeq}
        ,content_removal_bool = #{contentRemovalBool}
        ,depression_gas_replace_bool = #{depressionGasReplaceBool}
        ,bowl_open_pressure_release_bool = #{bowlOpenPressureReleaseBool}
        ,bowl_internal_cleaning_bool = #{bowlInternalCleaningBool}
        ,flammability_substance_removal_bool = #{flammabilitySubstanceRemovalBool}
        ,fire_extinguisher_function_check = #{fireExtinguisherFunctionCheck}
        ,safety_net_installation_bool = #{safetyNetInstallationBool}
        <where>
            user_firearms_safety_health_measures_requirements_seq = #{userFirearmsSafetyHealthMeasuresRequirementsSeq}
        </where>
    </update>

</mapper>