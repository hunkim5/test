<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.airpremia.eosh.authoritymanagement.authoritymanagement.repository.AuthorityManagementRepository">

    <select id="selectAuthorityManagementHrData" resultType="AuthorityManagementEntity">
          SELECT
            user_id
          FROM
            user
    </select>
    <select id="selectAuthorityManagementPage" resultType="AuthorityManagementDto">
          SELECT
            user_id
            ,user_grade_enum
          FROM
            user
        <where>
            <if test="@com.airpremia.esmsfos.core.MybatisUtils@isNotEmpty(searchDto.userGradeEnum)">
                AND user_grade_enum = #{searchDto.userGradeEnum}
            </if>
        </where>
    </select>
    <select id="selectAuthorityManagementList" resultType="AuthorityManagementDto">
          SELECT
            user_id
            ,CONCAT('P', SUBSTR( user_id,1,6)) AS empNo
            ,user_grade_enum
          FROM
            user
        <where>
            <if test="@com.airpremia.esmsfos.core.MybatisUtils@isNotEmpty(searchDto.userGradeEnum)">
                AND user_grade_enum = #{searchDto.userGradeEnum}
            </if>
        </where>
    </select>
    <select id="selectAuthorityManagement" resultType="AuthorityManagementDetailDto">
        SELECT
        user_id
        ,user_grade_enum
        FROM
        user
        WHERE user_seq = #{userSeq}
    </select>
    <update id="updateAuthorityManagement">
        UPDATE user
        SET
        user_grade_enum = #{userGradeEnum}
        ,update_user_id = #{updateUserId}
        ,update_ip = #{updateIp}
        <where>
            AND user_id = #{userId}
        </where>
    </update>
    <insert id="insertAuthorityManagementHr" useGeneratedKeys="true" keyProperty="userId">
        INSERT INTO user ( user_id
        ,user_grade_enum
        ,dept_cd
        ,insert_user_id
        ,insert_ip
        ) VALUES(
        #{userId}
        ,#{userGradeEnum}
        ,#{deptCd}
        ,#{insertUserId}
        ,#{insertIp}
        )
    </insert>
</mapper>
