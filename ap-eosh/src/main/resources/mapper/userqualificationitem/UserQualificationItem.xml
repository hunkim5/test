<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.airpremia.eosh.personaldetail.basicinfo.repository.UserQualificationItemRepository">

    <select id="selectUserQualificationItem" parameterType="UserQualificationItemDto">
           SELECT user_qualification_item_seq
            ,qualification_code
            ,user_seq
            ,qualification_expiration_dt
            ,attach_file_uuid
        FROM user_qualification_item
        WHERE user_seq = #{userSeq}
    </select>

    <select id="selectUserQualificationItemByUserId" parameterType="UserQualificationItemDto">
        SELECT uqi.user_qualification_item_seq
             ,uqi.qualification_code
             ,uqi.user_seq
             ,uqi.qualification_expiration_dt
             ,uqi.attach_file_uuid
        FROM user_qualification_item uqi
        JOIN user usr ON uqi.user_seq = usr.user_seq
        WHERE usr.user_id = #{userId}
    </select>

    <insert id="insertUserQualificationItem" useGeneratedKeys="true" keyProperty="userQualificationItemSeq">
        INSERT INTO user_qualification_item
        (user_seq
        ,qualification_code
        ,qualification_expiration_dt
        ,attach_file_uuid
        ,insert_ip
        ,insert_user_id
        ,insert_dtm)
 VALUES
        (#{userSeq}
        ,#{qualificationCode}
        ,#{qualificationExpirationDt}
        ,#{attachFileUuid}
        ,#{insertIp}
        ,#{insertUserId}
        ,CURRENT_TIMESTAMP(6))
    </insert>

    <update id="updateUserQualificationItem">
        UPDATE user_qualification_item
        SET
         qualification_expiration_dt = #{qualificationExpirationDt}
        ,attach_file_uuid = #{attachFileUuid}
        ,update_ip = #{updateIp}
        ,update_user_id = #{updateUserId}
        ,update_dtm = CURRENT_TIMESTAMP(6)
        WHERE
            user_qualification_item_seq = #{userQualificationItemSeq}
    </update>

    <delete id="deleteUserQualificationItem">
        DELETE
        FROM user_qualification_item
        WHERE
            user_qualification_item_seq = #{userQualificationItemSeq}
    </delete>
</mapper>
