<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.airpremia.eosh.report.workreport.reportcontract.repository.ReportContractRepository">
    <select id="selectReportContractPage" resultType="ReportContractPageDto">
        SELECT contract_seq
        ,report_no
        ,contract_incharge_department_code
        ,contract_incharge_department_name
        ,contract_incharge_id
        ,contract_incharge_name
        ,contract_company_name
        ,contract_company_incharge_name
        ,contract_company_contact
        ,contract_company_email
        ,contract_phase_code
        ,top_company_one_order
        ,top_company_two_order
        ,top_company_three_order
        ,company_grade_enum
        ,partner_company_workplace_code
        ,partner_company_workplace_text
        ,management_workplace_bool
        ,partner_major_work
        ,subcontracting_bool
        ,subcontracting_company_name
        ,add_comment
        ,attach_multiple_file_uuid
        ,feedback_content
        ,reject_reason
        ,safety_action_target_bool
        ,safety_health_consultative_group_bool
        ,safety_health_check_bool
        ,evaluation_target_bool
        ,approval_work_report_status_enum
        ,job_60_day_bool
        ,delivery_bool
        ,installation_maintenance_bool
        ,enter_company_bool
        ,routine_inspection_bool
        ,not_applicable_bool
        ,judgment_bool
        ,insert_dtm
        FROM report_contract
        <where>
            <if test="@com.airpremia.esmsfos.core.MybatisUtils@isNotEmpty(searchDto.contractCompanyName)">
                AND contract_company_name LIKE #{searchDto.contractCompanyName}
            </if>
            <if test="@com.airpremia.esmsfos.core.MybatisUtils@isNotEmpty(searchDto.contractCompanyInchargeName)">
                AND contract_company_incharge_name LIKE #{searchDto.contractCompanyInchargeName}
            </if>
            <if test="@com.airpremia.esmsfos.core.MybatisUtils@isNotEmpty(searchDto.contractCompanyContact)">
                AND contract_company_contact LIKE #{searchDto.contractCompanyContact}
            </if>
            <if test="@com.airpremia.esmsfos.core.MybatisUtils@isNotEmpty(searchDto.contractCompanyEmail)">
                AND contract_company_email LIKE #{searchDto.contractCompanyEmail}
            </if>
            <if test="@com.airpremia.esmsfos.core.MybatisUtils@isNotEmpty(searchDto.contractInchargeDepartmentCode)">
                AND contract_incharge_department_code = #{searchDto.contractInchargeDepartmentCode}
            </if>
            <if test="@com.airpremia.esmsfos.core.MybatisUtils@isNotEmpty(searchDto.companyGradeEnum)">
                AND company_grade_enum = #{searchDto.companyGradeEnum}
            </if>
        </where>
    </select>

    <select id="selectReportContract" resultType="ReportContractDto">
        SELECT contract_seq
             ,report_no
             ,contract_incharge_department_code
             ,contract_incharge_department_name
             ,contract_incharge_id
             ,contract_incharge_name
             ,contract_company_name
             ,contract_company_incharge_name
             ,contract_company_contact
             ,contract_company_email
             ,contract_phase_code
             ,top_company_one_order
             ,top_company_two_order
             ,top_company_three_order
             ,company_grade_enum
             ,partner_company_workplace_code
             ,partner_company_workplace_text
             ,management_workplace_bool
             ,partner_major_work
             ,subcontracting_bool
             ,subcontracting_company_name
             ,add_comment
             ,attach_multiple_file_uuid
             ,feedback_content
             ,reject_reason
             ,safety_action_target_bool
             ,safety_health_consultative_group_bool
             ,safety_health_check_bool
             ,evaluation_target_bool
             ,approval_work_report_status_enum
             ,job_60_day_bool
             ,delivery_bool
             ,installation_maintenance_bool
             ,enter_company_bool
             ,routine_inspection_bool
             ,not_applicable_bool
             ,judgment_bool
        FROM report_contract
        <where>
            contract_seq = #{contractSeq}
        </where>
    </select>

    <insert id="insertReportContract">
        INSERT INTO report_contract
        (report_no
        ,contract_incharge_department_code
        ,contract_incharge_department_name
        ,contract_incharge_id
        ,contract_incharge_name
        ,contract_company_name
        ,contract_company_incharge_name
        ,contract_company_contact
        ,contract_company_email
        ,contract_phase_code
        ,top_company_one_order
        ,top_company_two_order
        ,top_company_three_order
        ,company_grade_enum
        ,partner_company_workplace_code
        ,partner_company_workplace_text
        ,management_workplace_bool
        ,partner_major_work
        ,subcontracting_bool
        ,subcontracting_company_name
        ,add_comment
        ,attach_multiple_file_uuid
        ,feedback_content
        ,reject_reason
        ,safety_action_target_bool
        ,safety_health_consultative_group_bool
        ,safety_health_check_bool
        ,evaluation_target_bool
        ,approval_work_report_status_enum
        ,job_60_day_bool
        ,delivery_bool
        ,installation_maintenance_bool
        ,enter_company_bool
        ,routine_inspection_bool
        ,not_applicable_bool
        ,judgment_bool
        ,insert_ip
        ,insert_user_id)
        VALUES
            (#{reportNo}
            ,#{contractInchargeDepartmentCode}
            ,#{contractInchargeDepartmentName}
            ,#{contractInchargeId}
            ,#{contractInchargeName}
            ,#{contractCompanyName}
            ,#{contractCompanyInchargeName}
            ,#{contractCompanyContact}
            ,#{contractCompanyEmail}
            ,#{contractPhaseCode}
            ,#{topCompanyOneOrder}
            ,#{topCompanyTwoOrder}
            ,#{topCompanyThreeOrder}
            ,#{companyGradeEnum}
            ,#{partnerCompanyWorkplaceCode}
            ,#{partnerCompanyWorkplaceText}
            ,#{managementWorkplaceBool}
            ,#{partnerMajorWork}
            ,#{subcontractingBool}
            ,#{subcontractingCompanyName}
            ,#{addComment}
            ,#{attachMultipleFileUuid}
            ,#{feedbackContent}
            ,#{rejectReason}
            ,#{safetyActionTargetBool}
            ,#{safetyHealthConsultativeGroupBool}
            ,#{safetyHealthCheckBool}
            ,#{evaluationTargetBool}
            ,#{approvalWorkReportStatusEnum}
            ,#{job60DayBool}
            ,#{deliveryBool}
            ,#{installationMaintenanceBool}
            ,#{enterCompanyBool}
            ,#{routineInspectionBool}
            ,#{notApplicableBool}
            ,#{judgmentBool}
            ,#{insertIp}
            ,#{insertUserId})
    </insert>

    <update id="updateReportContract">
        UPDATE report_contract SET
        report_no = #{reportNo}
        ,contract_incharge_department_code = #{contractInchargeDepartmentCode}
        ,contract_incharge_department_name = #{contractInchargeDepartmentName}
        ,contract_incharge_id = #{contractInchargeId}
        ,contract_incharge_name = #{contractInchargeName}
        ,contract_company_name = #{contractCompanyName}
        ,contract_company_incharge_name = #{contractCompanyInchargeName}
        ,contract_company_contact = #{contractCompanyContact}
        ,contract_company_email = #{contractCompanyEmail}
        ,contract_phase_code = #{contractPhaseCode}
        ,top_company_one_order = #{topCompanyOneOrder}
        ,top_company_two_order = #{topCompanyTwoOrder}
        ,top_company_three_order = #{topCompanyThreeOrder}
        ,company_grade_enum = #{companyGradeEnum}
        ,partner_company_workplace_code = #{partnerCompanyWorkplaceCode}
        ,partner_company_workplace_text = #{partnerCompanyWorkplaceText}
        ,management_workplace_bool = #{managementWorkplaceBool}
        ,partner_major_work = #{partnerMajorWork}
        ,subcontracting_bool = #{subcontractingBool}
        ,subcontracting_company_name = #{subcontractingCompanyName}
        ,add_comment = #{addComment}
        ,attach_multiple_file_uuid = #{attachMultipleFileUuid}
        ,feedback_content = #{feedbackContent}
        ,reject_reason = #{rejectReason}
        ,safety_action_target_bool = #{safetyActionTargetBool}
        ,safety_health_consultative_group_bool = #{safetyHealthConsultativeGroupBool}
        ,safety_health_check_bool = #{safetyHealthCheckBool}
        ,evaluation_target_bool = #{evaluationTargetBool}
        ,approval_work_report_status_enum = #{approvalWorkReportStatusEnum}
        ,job_60_day_bool = #{job60DayBool}
        ,delivery_bool = #{deliveryBool}
        ,installation_maintenance_bool = #{installationMaintenanceBool}
        ,enter_company_bool = #{enterCompanyBool}
        ,routine_inspection_bool = #{routineInspectionBool}
        ,not_applicable_bool = #{notApplicableBool}
        ,judgment_bool = #{judgmentBool}
        ,update_ip = #{updateIp}
        ,update_user_id = #{updateUserId}
        <where>
            contract_seq = #{contractSeq}
        </where>
    </update>

    <update id="updateReportContractStatus">
        UPDATE report_contract SET
            approval_work_report_status_enum = #{approvalWorkReportStatusEnum}
            ,reject_reason = #{rejectReason}
        <where>
            contract_seq = #{contractSeq}
        </where>
    </update>

    <delete id="deleteReportContract">
        DELETE
        FROM report_contract
        <where>
            contract_seq = #{contractSeq}
        </where>
    </delete>

    <select id="selectContractReportCount" resultType="String">
        SELECT
        report_no
        FROM work_report_construction
        <where>
            report_no LIKE #{searchReportNumber}
        </where>
        ORDER BY report_no DESC
    </select>
</mapper>
